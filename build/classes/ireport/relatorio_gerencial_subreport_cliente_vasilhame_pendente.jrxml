<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="PessoasLista" pageWidth="554" pageHeight="802" columnWidth="554" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" uuid="051b4149-2a38-4aae-8017-4c4314811c48">
	<property name="ireport.scriptlethandling" value="0"/>
	<property name="ireport.encoding" value="UTF-8"/>
	<property name="ireport.zoom" value="1.5"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<import value="net.sf.jasperreports.engine.*"/>
	<import value="java.util.*"/>
	<import value="net.sf.jasperreports.engine.data.*"/>
	<queryString>
		<![CDATA[select e.nome_fantasia, e.ie, e.cnpj, c.id as codigoCliente, c.nome as nomeCliente, cv.quantidade as qtd_emprestimo,
(select IFNULL(sum(cvd.quantidade_devolvida), 0) from cliente_vasilhame_detalhe cvd where cvd.id_cliente_vasilhame = cv.id) as qtd_devolvida,
cv.quantidade - (select IFNULL(sum(cvd.quantidade_devolvida), 0) from cliente_vasilhame_detalhe cvd where cvd.id_cliente_vasilhame = cv.id) as qtd_restante
from empresa e, cliente c inner join venda_cabecalho vc ON c.id = vc.cliente_id
INNER JOIN venda_detalhe vd ON
vc.id = vd.venda_cabecalho_id
INNER JOIN cliente_vasilhame cv
ON vd.id = cv.id_venda_detalhe WHERE cv.status like 'P']]>
	</queryString>
	<field name="nome_fantasia" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="ie" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="cnpj" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="codigoCliente" class="java.lang.Integer"/>
	<field name="nomeCliente" class="java.lang.String"/>
	<field name="qtd_emprestimo" class="java.math.BigDecimal"/>
	<field name="qtd_devolvida" class="java.math.BigDecimal"/>
	<field name="qtd_restante" class="java.math.BigDecimal"/>
	<variable name="dataRel" class="java.util.Date" resetType="Page">
		<initialValueExpression><![CDATA[new java.util.Date()]]></initialValueExpression>
	</variable>
	<variable name="somaTotal" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{qtd_restante}]]></variableExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band height="13" splitType="Stretch">
			<staticText>
				<reportElement key="staticText-5" x="0" y="0" width="554" height="13" uuid="583d947c-3fc8-4200-94c7-c68b43883769"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Top">
					<font size="10" isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Relatório de vasilhames pendentes]]></text>
			</staticText>
			<line>
				<reportElement key="line-1" x="0" y="1" width="554" height="1" uuid="0559f773-45e8-47d0-8dff-d60bd7a7d8e0"/>
				<graphicElement>
					<pen lineWidth="0.25" lineStyle="Solid"/>
				</graphicElement>
			</line>
		</band>
	</pageHeader>
	<columnHeader>
		<band height="11" splitType="Stretch">
			<rectangle>
				<reportElement key="rectangle-1" x="0" y="0" width="554" height="11" forecolor="#CCCCCC" backcolor="#CCCCFF" uuid="a9c19709-b0c2-4906-b0b3-d27515f3ca6d"/>
			</rectangle>
			<staticText>
				<reportElement key="staticText-12" x="1" y="0" width="158" height="11" uuid="04e2b90e-62fe-4a49-a9d7-781103176bd2"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Cliente]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-19" x="378" y="0" width="89" height="11" uuid="6fa6c453-c6bd-4a8d-ac2d-8bb3fed35aa6"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Quantidade Devolvida]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-12" x="287" y="0" width="91" height="11" uuid="3f3148be-3d52-41be-91a3-ecc23f5dfcb8"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Quantidade Emprestada]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-19" x="467" y="0" width="87" height="11" uuid="a4849f44-313b-44b7-8645-93e4c9651469"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Quantidade Restante]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="10" splitType="Stretch">
			<rectangle>
				<reportElement x="0" y="0" width="554" height="10" backcolor="#CCCCFF" uuid="659b5861-fe64-4f7f-829c-a15b7ca48ab0">
					<printWhenExpression><![CDATA[new Boolean(($V{COLUMN_COUNT}.intValue() % 2) == 0)]]></printWhenExpression>
				</reportElement>
				<graphicElement>
					<pen lineWidth="0.0"/>
				</graphicElement>
			</rectangle>
			<textField>
				<reportElement x="1" y="0" width="252" height="10" uuid="e9b5b416-f24b-4c70-8aff-73170d9d4e8e"/>
				<textElement>
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{codigoCliente}.toString() + " - " + $F{nomeCliente}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00;(###0.00)">
				<reportElement x="287" y="0" width="91" height="10" uuid="e4542f01-060e-4514-bcfb-63f18cc6a03f"/>
				<textElement>
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{qtd_emprestimo}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00;(###0.00)">
				<reportElement x="378" y="0" width="89" height="10" uuid="81fb5240-8b10-4ffa-bb41-14d337b7c127"/>
				<textElement>
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{qtd_devolvida}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00;(###0.00)">
				<reportElement x="467" y="0" width="87" height="10" uuid="b4b485c9-1d02-4c80-9e80-fabe26cf8bb5"/>
				<textElement>
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{qtd_restante}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<summary>
		<band height="15" splitType="Stretch">
			<line>
				<reportElement key="line-3" x="0" y="1" width="554" height="1" uuid="4b30c4e8-ab0c-453e-af3c-3976b905ee6e"/>
				<graphicElement>
					<pen lineWidth="0.25" lineStyle="Solid"/>
				</graphicElement>
			</line>
			<staticText>
				<reportElement x="272" y="2" width="176" height="13" uuid="7fd2c7fe-56f6-41ac-bdc2-4edc25e3ba60"/>
				<textElement>
					<font size="10" isBold="true" isItalic="true"/>
				</textElement>
				<text><![CDATA[Total de vasilhames não devolvidos:]]></text>
			</staticText>
			<textField pattern="###0.00;(###0.00)">
				<reportElement x="448" y="2" width="106" height="13" uuid="73f3254d-4ed1-479b-ab40-4280743ae9b9"/>
				<textElement>
					<font size="10" isBold="true" isItalic="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{somaTotal}]]></textFieldExpression>
			</textField>
		</band>
	</summary>
</jasperReport>
